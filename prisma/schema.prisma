generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id          String        @id @default(uuid())
  email       String        @unique
  name        String
  nickname    String
  password    String
  status      Boolean
  googleId    String?
  createdAt   DateTime?     @default(now())
  updatedAt   DateTime?     @updatedAt
  Appointment Appointment[]
  Work        Work[]
  Payment     Payment[]

  @@map("users")
}

model Appointment {
  id            String            @id @default(uuid())
  userId        String
  user          User              @relation(fields: [userId], references: [id])
  workId        String
  work          Work              @relation(fields: [workId], references: [id])
  title         String
  date          DateTime
  status        AppointmentStatus @default(PENDENTE)
  paymentStatus PaymentStatus     @default(PENDENTE)
  paidAmount    Float             @default(0)
  createdAt     DateTime          @default(now())
  updatedAt     DateTime          @updatedAt
  Payment       Payment[]

  @@map("appointments")
}

model Work {
  id          String        @id @default(uuid())
  userId      String
  user        User          @relation(fields: [userId], references: [id])
  name        String
  description String?
  price       Float
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
  Appointment Appointment[]

  @@map("work")
}

model Payment {
  id            String        @id @default(uuid())
  userId        String
  user          User          @relation(fields: [userId], references: [id])
  appointmentId String
  appointment   Appointment   @relation(fields: [appointmentId], references: [id])
  amount        Float
  status        PaymentStatus @default(PENDENTE)
  method        String
  transactionId String        @unique
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt

  @@map("payments")
}

enum AppointmentStatus {
  CANCELADO
  PENDENTE
  CONCLUIDO
}

enum PaymentStatus {
  PENDENTE
  CONFIRMADO
}
